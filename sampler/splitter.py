'''
    Split instances of each class to its own CSV file.
'''
import csv
import sys

if len(sys.argv) < 4:
    sys.exit(
        'Wrong number of arguments!\n'
        'Parameters: input_filepath output_filepath0 output_filepath1\n'
        f'Example: python3 {sys.argv[0]} train.csv train0.csv train1.csv'
    )

input_filepath = sys.argv[1]
output_filepath0 = sys.argv[2]
output_filepath1 = sys.argv[3]

with open(input_filepath) as file_handle:
    output_file0 = open(output_filepath0, 'w')
    output_file1 = open(output_filepath1, 'w')

    reader = csv.reader(file_handle)
    header = next(reader)

    writer0 = csv.writer(output_file0)
    writer0.writerow(header)

    writer1 = csv.writer(output_file1)
    writer1.writerow(header)

    row_count0, row_count1 = 0, 0

    for row in reader:
        if row[-1] == '0':
            row_count0 += 1
            print(f'0: {row_count0}')
            writer0.writerow(row)
        elif row[-1] == '1':
            row_count1 += 1
            print(f'1: {row_count1}')
            writer1.writerow(row)
        else:
            print('Invalid row')

    output_file0.close()
    output_file1.close()

print('Finished')
print(f'0: {row_count0}')
print(f'1: {row_count1}')
